# Agent System Prompt Templates

This directory contains standardized templates for DA-to-agent context passing.

## Purpose

The templates provide a consistent structure for agent invocation prompts, ensuring:
1. **Role Extension** - Task-specific specialization of generic agent roles
2. **Johari Window Pass-Through** - Forward reasoning protocol discoveries to agents
3. **Structured Task Details** - Well-formatted task, requirements, and constraints
4. **Related Research Terms** - Keywords for knowledge discovery

## Key Design Principle

**All dynamic content is generated by the DA orchestrator, NOT by code.**

The template is a **passive structure** - it defines placeholders that the DA fills with dynamically generated content. The `prompt_builder.py` module is a simple assembler that substitutes values into the template.

## Template Files

| File | Purpose |
|------|---------|
| `agent-system-prompt.md` | Main template for agent invocation prompts |

## Template Placeholders

| Placeholder | Source | Description |
|-------------|--------|-------------|
| `{{task_id}}` | Skill state | Unique task identifier |
| `{{skill_name}}` | Skill state | Current skill being executed |
| `{{phase_id}}` | Skill state | Current phase within skill |
| `{{domain}}` | Reasoning protocol | Task domain (technical, personal, etc.) |
| `{{agent_name}}` | Phase config | Agent being invoked |
| `{{role_extension}}` | **DA generates** | Task-specific role specialization |
| `{{johari_open}}` | Reasoning Step 0 | Shared understanding |
| `{{johari_blind}}` | Reasoning Step 0 | Identified gaps |
| `{{johari_hidden}}` | Reasoning Step 0 | Discovered insights |
| `{{johari_unknown}}` | Reasoning Step 0 | Areas for exploration |
| `{{user_request}}` | User query | Original user request |
| `{{requirements_list}}` | **DA generates** | Task requirements |
| `{{constraints_list}}` | **DA generates** | Task constraints |
| `{{context_pattern}}` | Phase config | Context loading pattern |
| `{{predecessor_files}}` | Phase config | Memory files to load |
| `{{plan_section}}` | Execution state | Approved plan context |
| `{{phase_instructions}}` | Phase config | Phase-specific instructions |
| `{{memory_file_path}}` | Computed | Output memory file path |
| `{{related_research_terms}}` | **DA generates** | Search keywords |

## DA's Responsibilities

When invoking an agent, the DA MUST dynamically generate:

### Role Extension
- What specific aspects of this task should the agent focus on?
- What domain-specific considerations apply?
- What task-specific priorities should guide the agent?
- What quality criteria are most relevant?

### Related Research Terms (7-10 items)
- What keywords would help discover relevant information?
- What concepts are central to this task?
- What domain terminology applies?

### Requirements and Constraints
- What are the explicit requirements from the user?
- What constraints limit the approach?

## Usage

The template is used by `protocols/skill/core/prompt_builder.py`:

```python
from skill.core.prompt_builder import AgentPromptBuilder

builder = AgentPromptBuilder(
    task_id="...",
    skill_name="...",
    phase_id="...",
    agent_name="research",
    domain="technical",
    role_extension="[DA generates this dynamically]",
    research_terms="[DA generates this dynamically]",
    johari_findings={...},
    user_request="...",
    # ... other params
)

prompt = builder.build()
```

## Why Templates?

1. **Transparency** - Human-readable format documents the contract
2. **Maintainability** - Changes to prompt structure don't require Python changes
3. **Consistency** - All agent invocations follow the same structure
4. **Flexibility** - DA can customize any section dynamically

## Critical Invariants

1. **Template is passive** - It defines structure, not content
2. **DA generates all dynamic content** - No hardcoded dictionaries
3. **Builder only assembles** - Simple string substitution
4. **Johari flows through** - Reasoning findings reach agents
